# 企業一覧 画面仕様（権限設計込み）

---

## 画面名

企業一覧

---

## 目的

全ユーザーが企業一覧を確認できる。

---

## 対象スキーマ

```prisma
model Company {
  id       String  @id @default(cuid())
  name     String  @db.VarChar(200) // 企業名（必須 1〜200）
  industry String  @db.VarChar(100) // 業種（必須 1〜100）
  contact  String? @db.VarChar(500) // 連絡先（任意 0〜500）
  staff    String  @db.VarChar(100) // 担当者（必須 1〜100）

  @@map("companies")
}
```

---

## 表示項目

- ID
- 企業名
- 連絡先
- 業種
- 担当者

---

## 機能

- 企業詳細画面に遷移
- 企業新規作成画面に遷移
- 検索（企業名、連絡先、業種、担当者）
- ID / 企業名でソート（昇順 / 降順）
- バリデーション
- 権限チェック
  - 登録・編集権限がない場合は該当ボタンを表示しない（MVPではAPI側で制御してもよい）

---

## 挙動

- 企業選択後は企業詳細画面へ遷移
- 検索を入力し検索ボタンを押した後、企業一覧へ戻る
- ソート選択後、企業一覧へ戻る

---

## ルーティング

- 企業一覧：`/companies`
- 企業編集：`/companies/[companyId]`

---

## エラーメッセージ

- 検索失敗時：「検索ワードが適切ではありません」
  - 表示位置：検索フォームの下

---

## 権限設計（基本設計レベル）

### 利用者区分（ロール）

| ロール | 説明                       | 備考                  |
| ------ | -------------------------- | --------------------- |
| 営業   | 求職者・企業管理の実務担当 | MVPではこのロールのみ |

---

### データの見える範囲

| データ | 範囲 | 備考                               |
| ------ | ---- | ---------------------------------- |
| 企業   | 全件 | 全ユーザーが一覧・検索・ソート可能 |

---

### 業務機能別 権限

| 業務機能       | 営業 | 備考                     |
| -------------- | ---- | ------------------------ |
| 企業一覧を見る | ○    | `/companies`             |
| 企業詳細を見る | ○    | `/companies/[companyId]` |
| 企業を登録する | ○    | `/companies/new`         |
| 企業を編集する | ○    | `/companies/[companyId]` |

---

## 画面ルール

| 対象（画面） | エンティティ | 項目名 | 必須か | 入力制約   | 権限方針   | 履歴方針 | 一覧検索対象 | 並び順キー | 備考                   |
| ------------ | ------------ | ------ | ------ | ---------- | ---------- | -------- | ------------ | ---------- | ---------------------- |
| 企業一覧     | 企業         | 検索   | No     | 0〜255文字 | 全ユーザー | なし     | Yes          | No         | 複数項目を部分一致検索 |

---

## API 仕様

### 一覧取得

| 項目   | 内容               |
| ------ | ------------------ |
| 画面名 | 企業一覧           |
| 操作   | 一覧を取得         |
| 認証   | 要                 |
| 認可   | 企業一覧を見る権限 |
| Method | GET                |
| URL    | `/api/companies`   |

---

## API 振る舞いルール

- 未ログイン：401 Unauthorized
- 検索条件不正：400 BadRequest +「検索ワードが適切ではありません」
- 正常：200 OK + 一覧返却

---

## 技術前提

- Next.js(App Router)
- Auth.js v4
- Next API
- tailwind / shadcn
- Prisma
- Vitest + React Testing Library

---

## テスト観点

- 未ログインで 401
- 検索条件不正で 400
- 正常に一覧が取得できる
