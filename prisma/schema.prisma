generator client {
  provider = "prisma-client"
  output   = "../app/generated/prisma"
}

datasource db {
  provider = "postgresql"
}

/// 求職者ステータス（必要なら増やす）
enum JobSeekerStatus {
  NEW        // 新規
  INTERVIEWED // 面談済
  PROPOSING  // 提案中
  OFFERED    // 内定
  CLOSED     // 終了
}

model Company {
  id       Int     @id @default(autoincrement())
  name     String  @db.VarChar(255)
  industry String? @db.VarChar(255)
  contact  String? @db.VarChar(255)
  memo     String? @db.Text

  @@map("companies")
}

model SalesUser {
  id       Int      @id @default(autoincrement())
  name     String   @db.VarChar(255)
  password String   @db.VarChar(255)
  isActive Boolean  @default(true)

  jobSeekers JobSeeker[]

  @@map("sales_users")
}

model JobSeeker {
  id              Int             @id @default(autoincrement())
  salesUserId     Int
  name            String          @db.VarChar(255)
  age             Int?
  email           String?         @db.VarChar(255)
  phone           String?         @db.VarChar(255)
  desiredSalary   Int?
  desiredLocation String?         @db.VarChar(255)

  /// 画像では varchar だったけど、運用するなら enum 推奨
  status          JobSeekerStatus @default(NEW)

  memo            String?         @db.Text
  createdAt       DateTime        @default(now())
  updatedAt       DateTime        @updatedAt

  salesUser       SalesUser       @relation(fields: [salesUserId], references: [id])
  histories       JobSeekerHistory[]

  @@index([salesUserId])
  @@map("job_seekers")
}

model JobSeekerHistory {
  id         Int             @id @default(autoincrement())
  jobSeekerId Int
  status     JobSeekerStatus
  memo       String?         @db.Text
  createdAt  DateTime        @default(now())

  jobSeeker  JobSeeker       @relation(fields: [jobSeekerId], references: [id])

  @@index([jobSeekerId, createdAt])
  @@map("job_seeker_histories")
}